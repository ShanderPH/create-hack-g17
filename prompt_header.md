# Create Hack G17 - Plataforma Filantr√≥pica
## Prompt Header para Desenvolvimento Colaborativo

### üéØ **VIS√ÉO GERAL DO PROJETO**
Plataforma web para gest√£o e transpar√™ncia de atividades filantr√≥picas, conectando institui√ß√µes beneficentes com investidores atrav√©s de m√©tricas e visualiza√ß√µes geogr√°ficas.

---

## üèóÔ∏è **ARQUITETURA & STACK TECNOL√ìGICO**

### **Framework Principal**
- **Next.js 15.3.1** com App Router
- **React 18.3.1** com TypeScript 5.6.3
- **Turbopack** para desenvolvimento

### **UI & Styling**
- **HeroUI v2** (sistema de componentes baseado em Radix UI)
- **Tailwind CSS 4.1.11** com Tailwind Variants 2.0.1
- **Framer Motion 11.18.2** para anima√ß√µes
- **next-themes 0.4.6** para dark/light mode

### **Backend & Database**
- **Supabase** (PostgreSQL + Auth + Storage)
- **@supabase/supabase-js ^2.45.4**
- **Row Level Security (RLS)** para controle de acesso

### **Estado & Data Fetching**
- **Zustand ^4.5.5** para estado global da UI
- **TanStack Query ^5.56.2** para estado do servidor e cache
- **React Context** para autentica√ß√£o

### **Visualiza√ß√£o de Dados**
- **Tremor ^3.18.3** para charts e m√©tricas
- **MapBox GL ^3.6.0** + **react-map-gl ^7.1.7** para mapas interativos
- **react-icons ^5.3.0** para √≠cones

---

## üìÅ **ESTRUTURA DE DIRET√ìRIOS**

```
create-hack-g17/
‚îú‚îÄ‚îÄ app/                          # Next.js App Router
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                  # Dashboard principal (homepage)
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx                # Layout raiz com providers
‚îÇ   ‚îú‚îÄ‚îÄ providers.tsx             # Configura√ß√£o de providers
‚îÇ   ‚îú‚îÄ‚îÄ auth/page.tsx             # P√°gina de autentica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/page.tsx        # Dashboard espec√≠fico
‚îÇ   ‚îî‚îÄ‚îÄ [outras rotas]/
‚îú‚îÄ‚îÄ components/                   # Componentes React
‚îÇ   ‚îú‚îÄ‚îÄ ui/                       # Componentes at√¥micos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Button.tsx            # Wrapper do HeroUI Button
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Input.tsx             # Wrapper do HeroUI Input
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Card.tsx              # Componente Card customizado
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ NotificationSystem.tsx
‚îÇ   ‚îú‚îÄ‚îÄ auth/                     # Componentes de autentica√ß√£o
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuthProvider.tsx      # Provider de contexto
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LoginForm.tsx         # Formul√°rio de login/registro
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/                # Componentes do dashboard
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DashboardOverview.tsx # Vis√£o geral com m√©tricas
‚îÇ   ‚îú‚îÄ‚îÄ maps/                     # Componentes de mapas
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ InteractiveMap.tsx    # Mapa interativo com clusters
‚îÇ   ‚îú‚îÄ‚îÄ forms/                    # Formul√°rios
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ActivityForm.tsx      # Formul√°rio de atividades
‚îÇ   ‚îî‚îÄ‚îÄ navbar.tsx                # Navega√ß√£o principal
‚îú‚îÄ‚îÄ services/                     # Camada de servi√ßos
‚îÇ   ‚îú‚îÄ‚îÄ authService.ts            # Servi√ßos de autentica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ dataService.ts            # CRUD operations
‚îÇ   ‚îî‚îÄ‚îÄ mapService.ts             # Servi√ßos de mapas/geocoding
‚îú‚îÄ‚îÄ stores/                       # Estado global (Zustand)
‚îÇ   ‚îú‚îÄ‚îÄ authStore.ts              # Estado de autentica√ß√£o
‚îÇ   ‚îî‚îÄ‚îÄ uiStore.ts                # Estado da UI (modais, notifica√ß√µes)
‚îú‚îÄ‚îÄ hooks/                        # Custom hooks
‚îÇ   ‚îî‚îÄ‚îÄ useData.ts                # Hooks do TanStack Query
‚îú‚îÄ‚îÄ lib/                          # Configura√ß√µes e utilit√°rios
‚îÇ   ‚îú‚îÄ‚îÄ supabase.ts               # Cliente Supabase
‚îÇ   ‚îî‚îÄ‚îÄ queryClient.ts            # Configura√ß√£o TanStack Query
‚îú‚îÄ‚îÄ types/                        # Defini√ß√µes TypeScript
‚îÇ   ‚îú‚îÄ‚îÄ database.ts               # Tipos do banco de dados
‚îÇ   ‚îî‚îÄ‚îÄ index.ts                  # Tipos gerais
‚îî‚îÄ‚îÄ config/                       # Configura√ß√µes
    ‚îú‚îÄ‚îÄ site.ts                   # Configura√ß√£o do site
    ‚îî‚îÄ‚îÄ fonts.ts                  # Configura√ß√£o de fontes
```

---

## üóÑÔ∏è **SCHEMA DO BANCO DE DADOS**

### **Tabelas Principais**
```typescript
// institutions - Institui√ß√µes filantr√≥picas
{
  id: string (UUID)
  name: string
  description: string | null
  email: string
  phone: string | null
  address: string | null
  latitude: number | null
  longitude: number | null
  website: string | null
  logo_url: string | null
  category: string | null
  founded_year: number | null
  user_id: string (FK)
  created_at: string
  updated_at: string
}

// philanthropic_activities - Atividades filantr√≥picas
{
  id: string (UUID)
  title: string
  description: string | null
  category: string
  start_date: string
  end_date: string | null
  budget: number | null
  status: 'planning' | 'active' | 'completed' | 'cancelled'
  location: string | null
  latitude: number | null
  longitude: number | null
  beneficiaries_count: number | null
  institution_id: string (FK)
  created_at: string
  updated_at: string
}

// metrics - M√©tricas de impacto
{
  id: string (UUID)
  metric_type: string
  value: number
  unit: string | null
  description: string | null
  measurement_date: string
  activity_id: string | null (FK)
  institution_id: string (FK)
  created_at: string
  updated_at: string
}

// investors - Investidores
{
  id: string (UUID)
  name: string
  email: string
  phone: string | null
  company: string | null
  investment_focus: string | null
  user_id: string (FK)
  created_at: string
  updated_at: string
}
```

---

## üîÑ **FLUXO DE DADOS & ESTADO**

### **Gerenciamento de Estado**
1. **authStore (Zustand)**: Estado de autentica√ß√£o global
2. **uiStore (Zustand)**: Estado da UI (modais, notifica√ß√µes, layout)
3. **TanStack Query**: Cache e sincroniza√ß√£o de dados do servidor
4. **React Context**: Inicializa√ß√£o da autentica√ß√£o

### **Padr√µes de Data Fetching**
```typescript
// Hooks customizados em useData.ts
useInstitutions()           // Lista todas institui√ß√µes
useActivities(institutionId) // Atividades por institui√ß√£o
useMetrics(activityId)      // M√©tricas por atividade
useDashboardData(instId)    // Dados agregados do dashboard

// Muta√ß√µes com invalida√ß√£o autom√°tica
useCreateActivity()         // Cria atividade + invalida cache
useUpdateInstitution()      // Atualiza institui√ß√£o + invalida cache
```

### **Fluxo de Autentica√ß√£o**
1. **AuthProvider** inicializa estado na montagem
2. **authStore** gerencia sess√£o e usu√°rio
3. **RLS policies** no Supabase controlam acesso aos dados
4. **Navbar** mostra/esconde baseado no estado de auth

---

## üé® **SISTEMA DE DESIGN**

### **Tokens de Cor (HeroUI)**
```css
/* Use sempre tokens sem√¢nticos */
bg-content1          /* Background de cards */
bg-background        /* Background principal */
text-foreground      /* Texto principal */
text-default-500     /* Texto secund√°rio */
text-default-400     /* Placeholder text */
border-divider       /* Bordas */
text-primary         /* Cor prim√°ria */
text-danger          /* Cor de erro */
```

### **Responsividade**
- **Mobile-first**: Base styles para mobile
- **Breakpoints**: `sm:` (640px), `md:` (768px), `lg:` (1024px)
- **Componentes flex√≠veis**: Layouts que se adaptam automaticamente

### **Componentes At√¥micos**
- **Button**: Wrapper do HeroUI com variantes customizadas
- **Input**: Wrapper com styling consistente
- **Card**: Componente composto (Header, Content, Footer)

---

## üîß **PADR√ïES DE DESENVOLVIMENTO**

### **Estrutura de Componentes**
```typescript
// Sempre use "use client" para componentes interativos
"use client"

import { useState } from 'react'
import { useAuthStore } from '@/stores/authStore'
import { useUIStore } from '@/stores/uiStore'
import { Button } from '@/components/ui/Button'

export function MeuComponente() {
  // 1. Hooks de estado
  const [localState, setLocalState] = useState()
  
  // 2. Stores globais
  const { user } = useAuthStore()
  const { addNotification } = useUIStore()
  
  // 3. Data fetching
  const { data, isLoading } = useMinhaQuery()
  
  // 4. Event handlers
  const handleAction = async () => {
    try {
      // l√≥gica
      addNotification({ type: 'success', title: 'Sucesso!' })
    } catch (error) {
      addNotification({ type: 'error', title: 'Erro!' })
    }
  }
  
  // 5. Render com loading/error states
  if (isLoading) return <LoadingSkeleton />
  
  return (
    <div className="responsive-classes">
      {/* JSX */}
    </div>
  )
}
```

### **Tratamento de Erros**
- **TanStack Query**: Retry autom√°tico e error boundaries
- **Notifications**: Sistema centralizado via uiStore
- **Form validation**: Valida√ß√£o client-side + server-side

### **Performance**
- **Code splitting**: Componentes lazy quando apropriado
- **Query caching**: TanStack Query com stale-while-revalidate
- **Image optimization**: Next.js Image component

---

## üîê **SEGURAN√áA & AUTENTICA√á√ÉO**

### **Supabase Auth**
- **JWT tokens** para autentica√ß√£o
- **Row Level Security (RLS)** no PostgreSQL
- **OAuth providers** configur√°veis
- **Email confirmation** para novos usu√°rios

### **Controle de Acesso**
```sql
-- Exemplo de RLS policy
CREATE POLICY "Users can only see their own institutions"
ON institutions FOR SELECT
USING (auth.uid() = user_id);
```

### **Vari√°veis de Ambiente**
```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
NEXT_PUBLIC_MAPBOX_ACCESS_TOKEN=your_mapbox_token
```

---

## üìä **FUNCIONALIDADES IMPLEMENTADAS**

### ‚úÖ **Core Features**
- [x] Sistema de autentica√ß√£o completo
- [x] Dashboard com m√©tricas e gr√°ficos
- [x] CRUD de institui√ß√µes e atividades
- [x] Mapas interativos com clustering
- [x] Sistema de notifica√ß√µes
- [x] Dark/Light mode
- [x] Responsive design
- [x] Formul√°rios com valida√ß√£o

### ‚úÖ **Componentes UI**
- [x] Navbar com auth state
- [x] Cards responsivos
- [x] Bot√µes e inputs customizados
- [x] Modais e overlays
- [x] Loading skeletons
- [x] Sistema de notifica√ß√µes

---

## üöÄ **COMANDOS DE DESENVOLVIMENTO**

```bash
# Desenvolvimento
npm run dev          # Inicia servidor com Turbopack

# Build & Deploy
npm run build        # Build de produ√ß√£o
npm start           # Servidor de produ√ß√£o

# Linting
npm run lint        # ESLint com auto-fix
```

---

## ‚ö†Ô∏è **REGRAS CR√çTICAS PARA DESENVOLVIMENTO**

### **üé® Styling**
- **SEMPRE use tokens sem√¢nticos do HeroUI** (`text-foreground`, `bg-content1`, etc.)
- **NUNCA use cores hardcoded** (`text-gray-500`, `bg-white`, etc.)
- **Mobile-first**: Escreva CSS base para mobile, depois breakpoints

### **üîÑ Estado**
- **UI state**: Use `uiStore` (modais, notifica√ß√µes, layout)
- **Server state**: Use TanStack Query hooks
- **Auth state**: Use `authStore`
- **Local state**: Use `useState` apenas para estado local

### **üì° Data Fetching**
- **SEMPRE use hooks customizados** de `useData.ts`
- **Invalida√ß√£o autom√°tica**: Muta√ß√µes devem invalidar queries relacionadas
- **Loading states**: Sempre trate estados de loading/error

### **üîê Seguran√ßa**
- **RLS policies**: Sempre configure no Supabase
- **Valida√ß√£o**: Client-side + server-side
- **Env vars**: Nunca commite secrets

### **üì± Responsividade**
- **Teste em mobile**: Sempre verifique em telas pequenas
- **Flexbox/Grid**: Use para layouts adaptativos
- **Touch targets**: Bot√µes com tamanho m√≠nimo 44px

### **üß© Componentes**
- **"use client"**: Para componentes interativos
- **TypeScript**: Sempre tipado, use interfaces do database.ts
- **Error boundaries**: Trate erros graciosamente
- **Accessibility**: Use semantic HTML e ARIA

---

## üìù **EXEMPLO DE IMPLEMENTA√á√ÉO**

```typescript
// Exemplo de nova feature seguindo os padr√µes
"use client"

import { useState } from 'react'
import { useCreateMetric } from '@/hooks/useData'
import { useAuthStore } from '@/stores/authStore'
import { useUIStore } from '@/stores/uiStore'
import { Button } from '@/components/ui/Button'
import { Input } from '@/components/ui/Input'
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/Card'

interface MetricFormProps {
  activityId: string
  onSuccess?: () => void
}

export function MetricForm({ activityId, onSuccess }: MetricFormProps) {
  const [formData, setFormData] = useState({
    metric_type: '',
    value: '',
    unit: '',
    description: ''
  })
  
  const { user } = useAuthStore()
  const { addNotification } = useUIStore()
  const createMetric = useCreateMetric()
  
  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    
    if (!user?.user_metadata?.institution_id) {
      addNotification({
        type: 'error',
        title: 'Erro',
        message: 'Usu√°rio deve estar associado a uma institui√ß√£o'
      })
      return
    }
    
    try {
      await createMetric.mutateAsync({
        ...formData,
        value: parseFloat(formData.value),
        activity_id: activityId,
        institution_id: user.user_metadata.institution_id,
        measurement_date: new Date().toISOString()
      })
      
      onSuccess?.()
    } catch (error) {
      // Error handling √© feito no hook
    }
  }
  
  return (
    <Card className="w-full max-w-md">
      <CardHeader>
        <CardTitle>Nova M√©trica</CardTitle>
      </CardHeader>
      <CardContent>
        <form onSubmit={handleSubmit} className="space-y-4">
          <Input
            placeholder="Tipo de m√©trica"
            value={formData.metric_type}
            onChange={(e) => setFormData(prev => ({ 
              ...prev, 
              metric_type: e.target.value 
            }))}
            required
          />
          
          <div className="flex gap-2">
            <Input
              type="number"
              placeholder="Valor"
              value={formData.value}
              onChange={(e) => setFormData(prev => ({ 
                ...prev, 
                value: e.target.value 
              }))}
              required
              className="flex-1"
            />
            <Input
              placeholder="Unidade"
              value={formData.unit}
              onChange={(e) => setFormData(prev => ({ 
                ...prev, 
                unit: e.target.value 
              }))}
              className="w-24"
            />
          </div>
          
          <Button 
            type="submit" 
            disabled={createMetric.isPending}
            className="w-full"
          >
            {createMetric.isPending ? 'Salvando...' : 'Salvar M√©trica'}
          </Button>
        </form>
      </CardContent>
    </Card>
  )
}
```

---

**üéØ Use este prompt header como refer√™ncia para manter consist√™ncia arquitetural e seguir os padr√µes estabelecidos no projeto Create Hack G17.**
